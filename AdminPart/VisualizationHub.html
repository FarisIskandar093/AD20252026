<div class="w3-container">
    <h2 class="w3-text-purple">ðŸ“Š Visualization Hub</h2>
    <p class="w3-text-grey">Interactive data visualizations for TTMS analytics</p>
    
    <div class="w3-bar w3-light-grey w3-round w3-margin-bottom">
        <button class="w3-bar-item w3-button w3-purple" onclick="showVizTab('overview')">Overview</button>
        <button class="w3-bar-item w3-button" onclick="showVizTab('temporal')">Temporal Analysis</button>
        <button class="w3-bar-item w3-button" onclick="showVizTab('spatial')">Spatial Analysis</button>
        <button class="w3-bar-item w3-button" onclick="showVizTab('predictive')">Predictive Insights</button>
    </div>
    
    <div id="vizTabContent">
        <!-- Content loaded dynamically -->
    </div>
    
    <div class="w3-panel w3-light-blue w3-round w3-margin-top">
        <h5>ðŸ’¡ Visualization Tips</h5>
        <p>â€¢ Hover over charts for detailed information</p>
        <p>â€¢ Click and drag to zoom in on specific areas</p>
        <p>â€¢ Use filters to customize the data view</p>
        <p>â€¢ Export any visualization using the menu button</p>
    </div>
</div>

<script>
$(document).ready(function() {
    showVizTab('overview');
    
    function showVizTab(tab) {
        // Update active button
        $('.w3-bar-item.w3-button').removeClass('w3-purple');
        $(`.w3-bar-item.w3-button:contains('${tab.charAt(0).toUpperCase() + tab.slice(1)}')`).addClass('w3-purple');
        
        let content = '';
        
        switch(tab) {
            case 'overview':
                content = `
                    <div class="w3-row-padding">
                        <div class="w3-col m6">
                            <div class="w3-card w3-padding">
                                <h4>System Health Dashboard</h4>
                                <div id="healthDashboard" style="width:100%; height:300px;"></div>
                            </div>
                        </div>
                        <div class="w3-col m6">
                            <div class="w3-card w3-padding">
                                <h4>Resource Allocation</h4>
                                <div id="resourceAllocation" style="width:100%; height:300px;"></div>
                            </div>
                        </div>
                    </div>
                `;
                break;
                
            case 'temporal':
                content = `
                    <div class="w3-card w3-padding">
                        <h4>Temporal Analysis</h4>
                        <p>Analyze patterns over time</p>
                        <div id="temporalChart" style="width:100%; height:400px;"></div>
                    </div>
                `;
                break;
                
            case 'spatial':
                content = `
                    <div class="w3-card w3-padding">
                        <h4>Spatial Analysis</h4>
                        <p>Room and building utilization</p>
                        <div id="spatialChart" style="width:100%; height:400px;"></div>
                    </div>
                `;
                break;
                
            case 'predictive':
                content = `
                    <div class="w3-card w3-padding">
                        <h4>Predictive Insights</h4>
                        <p>Forecasting and trend analysis</p>
                        <div id="predictiveChart" style="width:100%; height:400px;"></div>
                    </div>
                `;
                break;
        }
        
        $("#vizTabContent").html(content);
        
        // Load appropriate visualizations
        setTimeout(() => {
            if (tab === 'overview') loadOverviewCharts();
            else if (tab === 'temporal') loadTemporalAnalysis();
            else if (tab === 'spatial') loadSpatialAnalysis();
            else if (tab === 'predictive') loadPredictiveInsights();
        }, 100);
    }
    
    window.showVizTab = showVizTab;
    
    function loadOverviewCharts() {
        // Load health dashboard
        const healthData = new google.visualization.DataTable();
        healthData.addColumn('string', 'Metric');
        healthData.addColumn('number', 'Value');
        healthData.addColumn({type: 'string', role: 'style'});
        
        healthData.addRows([
            ['Data Integrity', 95, 'color: #4caf50'],
            ['System Uptime', 99, 'color: #2196f3'],
            ['API Response', 98, 'color: #9c27b0'],
            ['User Satisfaction', 92, 'color: #ff9800']
        ]);
        
        const healthOptions = {
            title: 'System Health Metrics',
            legend: { position: 'none' },
            vAxis: { minValue: 0, maxValue: 100, format: '#\'%\'' }
        };
        
        const healthChart = new google.visualization.ColumnChart(document.getElementById('healthDashboard'));
        healthChart.draw(healthData, healthOptions);
        
        // Load resource allocation
        const resourceData = new google.visualization.DataTable();
        resourceData.addColumn('string', 'Resource');
        resourceData.addColumn('number', 'Usage');
        
        resourceData.addRows([
            ['Classrooms', 75],
            ['Laboratories', 60],
            ['Study Spaces', 40],
            ['Common Areas', 30]
        ]);
        
        const resourceOptions = {
            title: 'Resource Allocation & Usage',
            is3D: true,
            colors: ['#2196f3', '#4caf50', '#ff9800', '#9c27b0']
        };
        
        const resourceChart = new google.visualization.PieChart(document.getElementById('resourceAllocation'));
        resourceChart.draw(resourceData, resourceOptions);
    }
});

// Load Google Charts
google.charts.load('current', {'packages':['corechart']});
</script>